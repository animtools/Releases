# VideoTileKun - ユーザーガイド（デスクトップ版）

動画のタイルプレビューとライブラリ管理ができる Windows 用デスクトップアプリの操作説明です。

---

## 1. 概要と2つのウィンドウ

VideoTileKun は **プレーヤーウィンドウ** と **ライブラリ（ブラウザ）ウィンドウ** の2つで構成されています。

| ウィンドウ | 役割 |
|------------|------|
| **プレーヤー** | 起動時に最初に開くウィンドウ。動画の再生・シーク・**タイル（サムネイル）の生成**、タイムライン上のマーカー編集などを行います。生成したタイルはライブラリフォルダに自動でストックされます。 |
| **ライブラリ** | ライブラリフォルダ内の動画を一覧表示し、**プレーヤーへ動画を読み込む**・タグで絞り込み・タイルの確認・一括削除など、ライブラリの管理を行います。 |

- **起動**: exe を実行すると **プレーヤーウィンドウ** が開きます。
- **ライブラリを開く**: プレーヤーのヘッダーにある **ライブラリボタン**（または **Ctrl+L**）でライブラリウィンドウを開閉します。

---

## 2. ライブラリフォルダの設定

生成したタイル（サムネイル画像とメタデータ）は、**ライブラリフォルダ** 内の `.video-tile-kun` フォルダに保存されます。動画ファイルの実体は、あなたが指定したフォルダのまま移動しません。

### 2.1 初期状態

- **未設定時**: 起動ファイル（exe）と同じ場所に **VideoTileKun-Library** フォルダが自動作成され、そこがライブラリフォルダとして使われます（ポータブル利用向け）。
- ライブラリウィンドウのタイトルバーに表示される **フォルダアイコンボタン** で、現在のライブラリフォルダを確認・変更できます。

### 2.2 ライブラリフォルダの変更

1. **ライブラリウィンドウ** を開く（プレーヤーのライブラリボタンまたは Ctrl+L）。
2. タイトルバー右側の **フォルダアイコン** をクリック。
3. 表示されたパネルで **「Change...」** をクリックし、フォルダを選択（空のフォルダでも可）。
4. **「Use default (next to exe)」** を選ぶと、exe 横の VideoTileKun-Library に戻します。

プレーヤーとライブラリは **同じライブラリフォルダ** を共有します。ライブラリ側で変更すると、プレーヤー側のタイル保存先も同じになります。

---

## 3. プレーヤーウィンドウ

### 3.1 全体レイアウト

| 領域 | 説明 |
|------|------|
| **ヘッダー** | タイトル、再生情報（時間・マーカー数）、設定ボタン、**ライブラリボタン**、ウィンドウコントロール（最前面固定・最小化・最大化・閉じる） |
| **左パネル** | プレイリスト等（折りたたみ可能。エディションにより表示が異なります） |
| **中央** | 動画エリア、再生コントロール、**タイムライン**（再生位置・サムネイルマーカー） |
| **右パネル** | **タイルビューア**（再生中動画のタイル一覧）。幅はリサイズ可能 |
| **設定パネル** | 設定ボタンで右からスライドイン。バックドロップクリックまたは閉じるボタン・Esc で閉じる |

### 3.2 動画を開く

- **ファイルから**: メニューや「ファイルを開く」で動画ファイルを指定。
- **ライブラリから**: ライブラリウィンドウで動画カードを **ダブルクリック** すると、その動画がプレーヤーで開き、前面に表示されます。シングルクリックでは「選択」のみで、再生はしません。

### 3.3 再生コントロール（中央下）

- **再生 / 一時停止**
- **スキップ（戻る / 進む）**: 設定の「スキップ秒数」で 5 / 10 / 30 / 60 秒を変更可能
- **再生速度**: 0.1x ～ 2x（ダブルクリックで 1x にリセット）
- **動画回転**: ボタンドラッグで回転、クリックで 0° リセット
- **音量スライダー・ミュート**
- **フルスクリーン**
- **ヘルプ**: ショートカット一覧を約 3 秒表示

### 3.4 タイムライン

- **再生位置バー**: ドラッグでシーク。バッファ表示あり。
- **サムネイルマーカー**: タイルデータの各時刻にマーカー表示。**クリックでその位置へシーク**。ホバーで該当時刻のプレビュー表示。
- **マーカー追加**: 現在位置（K）またはホバー位置（F）で追加。Delete / Backspace で選択中のマーカーを削除。
- マーカーにタグアイコンを表示する設定も可能（設定パネルでタグアイコンを登録）。

### 3.5 タイルビューア（右パネル）

- 再生中（または選択中）の動画のタイルを表示。タイルがまだない動画の場合は「動画を再生するか…」などのメッセージ。
- **タイル**: クリックで選択、**ダブルクリックでその時刻にシーク**、右クリックでコンテキストメニュー（タグ編集・削除・コピー等）。
- サイズスライダー・アスペクト比（設定と連動）。
- 選択タイルの削除・クリップボードコピー（Ctrl+C）・書き出し（エディションにより利用可否が異なります）。

### 3.6 タイルの生成（プレーヤー）

1. プレーヤーで動画を開く。
2. 右パネル（タイルビューア）付近または設定で **「タイルを生成」** を実行。
3. 生成設定（最小/最大グリッド、間隔（秒）、サイズ（px））は設定パネルの「タイル設定」で変更可能。動画読込時に自動生成するオプションもあります。
4. 生成が終わると、タイルは **ライブラリフォルダ** の `.video-tile-kun/<id>/` に保存され、ライブラリウィンドウの一覧にも反映されます。

### 3.7 設定パネル（主な項目）

- **再生設定**: デフォルト音量・再生速度、スキップ秒数、フレームドラッグ感度、動画読込時の再生設定を固定するか
- **ウィンドウ設定**: ウィンドウ位置を記憶、最後の動画を記憶
- **タイル設定**: 生成設定（グリッド・間隔・サイズ・自動生成）、表示設定（アスペクト比、タグ表示）
- **タグプリセット**: ワンクリックでタグを付与/解除するプリセットの作成・選択・削除
- **キーボードショートカット**: 一覧とキー割り当ての変更
- **表示調整**: 明るさ・コントラスト・彩度（動画表示のみ。ファイルは変更しない）
- **データ管理**: 設定等のエクスポート/インポート/クリア
- **タイルデータのクリーンアップ**: ライブラリ内の全 VideoTileKun データ（サムネイルフォルダ・タグ）を削除（取り消し不可）

### 3.8 キーボードショートカット（デフォルト例）

| 操作 | キー |
|------|------|
| 再生 / 一時停止 | Space |
| スキップ（戻る / 進む） | ← / →（Shift+←/→ で 1 秒） |
| 10秒戻る / 進む | J / L |
| フレーム戻し / 送り | , / . |
| 前のマーカー / 次のマーカー | A / D |
| 現在位置にマーカー追加・削除 | K |
| ホバー位置にマーカー追加 | F |
| ミュート切替 | M |
| 選択削除（タイル or マーカー） | Delete / Backspace |
| クリップボードにコピー（タイル1枚選択時） | Ctrl+C |

設定パネル表示中は **Escape** でパネルを閉じます。入力欄にフォーカスがあるときはショートカットは無効です。

---

## 4. ライブラリ（ブラウザ）ウィンドウ

ライブラリウィンドウでは、ライブラリフォルダに登録された動画を一覧し、プレーヤーへ読み込んだり、タイルの生成・削除を行います。

### 4.1 タイトルバー

| 要素 | 説明 |
|------|------|
| **検索** | 名前で絞り込み（Search by name…） |
| **並び替え** | Name (A–Z / Z–A)、Last opened、Added、Last edited など |
| **Columns** | グリッドの列数（1～10） |
| **サイドバー / インスペクタ** | 左のタグ一覧・右のインスペクタの表示/非表示トグル |
| **件数** | 表示中のアイテム数 |
| **フォルダアイコン** | ライブラリフォルダの確認・変更（「Library Folder」パネル） |
| **ウィンドウコントロール** | 最小化・最大化・閉じる |

### 4.2 グリッド（中央）

- ライブラリに登録された動画が **カード** で一覧表示されます。
- **シングルクリック**: カードを選択（複数選択は Ctrl+クリック、Shift+クリックで範囲選択）。
- **ダブルクリック**: その動画を **プレーヤーで開く**（プレーヤーが前面に出ます）。
- **右クリック**: コンテキストメニュー（プレーヤーで開く、削除など）。

### 4.3 サイドバー（タグ）

- 左側に **タグ一覧** が表示されます。タグをクリックすると、そのタグが付いた動画だけに絞り込まれます。
- **Refresh**: タグ一覧を再取得して更新します。

### 4.4 ツールバー（選択時）

- 1件以上選択すると **ツールバー** が表示されます。
- **Delete**: 選択したアイテムをライブラリから削除。タイルデータ（.video-tile-kun 内）の削除有無を選べる場合があります。
- **Inspect**: 右側のインスペクタを開き、選択アイテムの詳細・タイル操作を表示します。

### 4.5 インスペクタ（右パネル）

- **1件選択時**: その動画の **タイルグリッド** が表示されます（VideoTileKun のインスペクタ相当）。
  - **タイルを生成**: この動画からサムネイルを生成。生成先はライブラリフォルダ内です。
  - **この動画のタイルを削除**: この動画のタイルデータのみ削除（確認ダイアログあり）。
  - **ホバープレビュー**: タイルにマウスを乗せると、その時刻の動画プレビューを再生。音量・ミュート・シーク（左右キー・ドラッグ）も可能。
  - **タイルサイズスライダー**: 表示サイズを変更。
  - **設定**: タイル生成設定（Min/Max Grid、Interval、Size 等）・表示調整・ホバー設定・タイルデータのクリーンアップ。
- **タイルの操作**: タイルをクリックで選択、ダブルクリックでプレーヤーでその時刻から再生をキュー。右クリックでコンテキストメニュー（プレーヤーで開く、画像コピー、タグ編集など）。
- **複数選択時**: インスペクタに複数選択用の情報や一括操作が表示されます。

### 4.6 動画の追加（ドラッグ＆ドロップ）

- ライブラリウィンドウに **動画ファイル** または **フォルダ** をドラッグ＆ドロップすると、「Drop video file(s) to import」のオーバーレイが表示されます。
- **ファイルをドロップ**: それらの動画がライブラリに登録され、必要に応じて **バッチでタイル生成** が開始されます（進捗はステータスバーに表示）。
- **フォルダをドロップ**: フォルダ内の動画が一覧され、同様に登録・タイル生成の対象にできます。
- タイル生成の設定（グリッド・間隔・サイズ）は、プレーヤー側の現在の設定が使われる場合があります。

### 4.7 ステータスバー（バッチ処理時）

- ドロップによる一括タイル生成などで、画面下部に **ステータスバー** が表示され、進捗（現在枚数/総数・メッセージ）が示されます。

---

## 5. タイルの生成と管理の流れ（まとめ）

1. **ライブラリフォルダを決める**  
   ライブラリウィンドウのフォルダアイコンから変更（未設定なら exe 横の VideoTileKun-Library）。

2. **動画をプレーヤーで開く**  
   ファイルを開くか、ライブラリでカードをダブルクリック。

3. **タイルを生成する**  
   - **プレーヤー**: 右パネルの「タイルを生成」等で実行。  
   - **ライブラリ**: 1件選択してインスペクタを開き、「タイルを生成」で実行。  
   - **一括**: ライブラリに動画をドロップすると、バッチでタイル生成される場合があります。

4. **タイルの保存先**  
   生成されたタイルは、ライブラリフォルダ内の `.video-tile-kun/<id>/` に保存され、ライブラリの一覧・インスペクタ・プレーヤーのタイムラインマーカーで参照されます。

5. **プレーヤーで見る**  
   ライブラリで動画をダブルクリックしてプレーヤーで開くと、タイムラインにマーカーが並び、タイルビューアでタイルをクリックしてシークできます。

---

## 6. 困ったとき

- **起動しない**: Windows 10/11 64bit か確認してください。別の PC やユーザーで試すと原因の切り分けに役立ちます。
- **「Windows が PC を保護しました」と出る**: 署名していないためです。「詳細情報」→「実行」で起動できます。
- **タイルが生成されない**: 動画の形式やコーデックによっては失敗することがあります。別の動画で試すか、Issue でファイル形式を添えて報告してください。
- **ライブラリが空のまま**: ライブラリフォルダをフォルダアイコンで確認し、動画をドロップするか、プレーヤーで「ファイルを開く」してからタイルを生成すると登録されます。
- **プレーヤーに動画が読み込まれない**: ライブラリでカードを **ダブルクリック** してください。シングルクリックは選択のみです。また、元の動画ファイルが移動・削除されていないか確認してください。

その他の不具合報告・質問は、リポジトリ共通の [SUPPORT](../../SUPPORT.md) からお願いします。

---

## 関連ドキュメント

- [README（説明・動作環境）](./README.md)
- [クイックスタート](./QUICKSTART.md)
- [CHANGELOG](./CHANGELOG.md)
