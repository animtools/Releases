# Eagle プラグインセット - ユーザーガイド

VideoTileKun 系 3 プラグインの役割と、基本的な使い方をまとめています。  
（簡潔・実用的。機能の「何ができるか」を中心に。）

---

## 1. 概要

VideoTileKun は Eagle の動画管理を強化する 3 つのプラグインシリーズです。

| プラグイン                    | 役割                                       |
| ----------------------------- | ------------------------------------------ |
| **VideoTileKun Inspector**    | サムネイルタイル表示・ホバープレビュー     |
| **VideoTileKun Player**       | タイムライン付き動画プレーヤー             |
| **VideoTileKun Service**      | 起動中に追加した動画のサムネイルを自動取得 |

Inspector と Player は**それぞれ単体で利用できます**。両方入れると、Inspector のタイルから Player を起動するなど連携が使えて便利です。Service は、プラグイン起動後にライブラリに追加された動画のサムネイルを自動で取得したい場合のオプションです（既存の大量動画を一括処理する機能はありません）。

---

## 2. インストール

### 手順

1. 配布された `.eaglepack` ファイルをダウンロード
2. Eagle の画面にドラッグ＆ドロップ（またはダブルクリック）
3. Eagle がプラグインのインストールを確認 → 「インストール」を選択
4. 3 つのプラグインそれぞれに対してこの手順を繰り返す

### FFmpeg の準備

タイル生成には FFmpeg が必要です。Eagle の設定から FFmpeg をインストールしてください。

> Eagle メニュー → プラグイン → 設定 → FFmpeg をインストール

### プラグインの起動

Eagle 上部メニューの「プラグイン」から各プラグインを選んで起動します。Inspector はサイドパネル、Player は独立ウィンドウとして開きます。

---

## 3. VideoTileKun Inspector

Eagle のインスペクタ領域に表示されるメインプラグイン。動画を選択すると、その動画のサムネイルタイルが一覧表示されます。

### 基本操作

- **動画を選択**: Eagle で動画アイテムを選択すると、自動的にタイルが表示されます
- **タイル生成**: 初回は生成ボタン（グリッドアイコン）をクリックしてサムネイルを生成
- **タイル削除**: ゴミ箱アイコンで生成済みタイルを削除

### ホバープレビュー

タイル上にマウスを置くと、その時点の動画をプレビュー再生できます。

- **ホイール**: 再生位置を前後にシーク
- **Shift+ホイール**: 大きくシーク（倍率は設定で変更可能）
- **ドラッグ（左右）**: スクラブ再生
- **ドラッグ（上下）**: 音量調整
- **クリック**: 一時停止/再生の切り替え

ヘッダーの再生ボタンでホバープレビューの有効/無効を切り替えます。

### 設定

歯車アイコンから設定パネルを開けます。

- **Min/Max Grid**: タイルのグリッドサイズ範囲（2〜5 など）
- **Interval**: サムネイル抽出間隔（秒）
- **Size**: サムネイル画質（px）。大きいほど高画質だがファイルサイズ増
- **Hover zoom**: ホバー時の拡大倍率
- **表示調整**: 明るさ・コントラスト・彩度（表示のみ、ファイル非変更）

### タイルサイズ

設定パネルの下にあるスライダーで、表示上のタイルサイズをリアルタイムに調整できます。

### タグ編集

タイルを右クリック → 「タグ編集」で、個別のタイルにタグを付けられます。タグは meta.json に保存され、タイル上にオーバーレイ表示されます。

### 対応形式

mp4, mov, avi, mkv, webm, m4v, flv, wmv など。**FFmpeg プラグイン**のインストールが必要です。

---

## 4. Player（VideoTileKun Player）

独立ウィンドウの動画プレーヤー。タイムライン上にサムネイルマーカーが表示され、動画の構造を俯瞰しながら再生できます。

### 基本操作

- **再生/一時停止**: 再生ボタンまたは Space キー
- **シーク**: タイムラインをクリック、またはドラッグ
- **タイムラインホバー**: マウスを合わせるとプレビューフレームが表示されます
- **ダブルクリック**: Eagle で選択中の動画を読み込み

### キーボードショートカット

| キー   | 操作                                         |
| ------ | -------------------------------------------- |
| Space  | 再生/一時停止                                |
| ← / →  | スキップ（戻る/進む）                        |
| J / L  | 10秒戻る/進む                                |
| , / .  | 1フレーム戻し/送り                           |
| A / D  | 前/次のマーカーへジャンプ                    |
| K      | 現在位置にマーカー追加/削除                  |
| F      | タイムラインホバー位置にマーカー追加         |
| M      | ミュート切り替え                             |
| Delete | 選択中のマーカーを削除                       |
| Ctrl+C | 選択中のマーカー画像をクリップボードにコピー |

> ショートカットは設定パネルからカスタマイズ可能です。

### 再生コントロール

- **再生速度**: 速度コンボボックスで変更（ダブルクリックで 1x にリセット）
- **回転**: 回転ボタンをドラッグして回転（クリックでリセット）
- **ズーム/パン**: Ctrl+ホイールでズーム、Ctrl+ドラッグでパン
- **ビューリセット**: リセットボタンで回転・ズーム・パンをすべてリセット

### タイルビューワー（右ペイン）

右ペインにサムネイルタイルが一覧表示されます。

- **タイル生成**: 生成ボタンでタイムライン上にマーカー付きのサムネイルを生成
- **タイル選択**: クリックで選択、選択中のマーカー位置にシーク
- **ペインの折りたたみ**: ヘッダーのボタンで左右ペインを折りたたみ/展開

### ウィンドウ設定

- **常に最前面**: ピンアイコンで切り替え
- **ウィンドウ位置記憶**: 次回起動時に前回の位置・サイズを復元
- **フルスクリーン**: ヘッダーボタンで切り替え

### 補足

追加のプラグインは不要です。Inspector で生成したタイルがあれば、プレーヤー側のタイルビューでも参照できます。

---

## 5. Service（VideoTileKun Service）

バックグラウンドで動作し、**Service を有効にしたあと**にライブラリに追加（インポート）された動画について、タイル未生成なら自動でサムネイルを生成します。既にライブラリにある動画を一括処理する機能はありません。

### 使い方

1. Eagle のプラグインメニューから Service を起動
2. 設定で「Enable auto tile generation on video import」をオンにする
3. Service が一定間隔でライブラリをポールし、「有効化以降にインポートされた」かつ「タイル未生成」の動画をキューに追加
4. キューに載った動画を順にサムネイル生成し、完了すると Inspector で表示されます

Service は起動しておくだけで動作します。既存の動画は処理対象にせず、有効化後に追加した動画だけを自動で処理します。

### 無効化したい場合

プラグインの設定で「自動タイル生成」をオフにすると、Service の自動生成だけを止められます。Inspector での手動生成は引き続き利用できます。

### 通知

処理中・完了・エラーを Eagle の通知などで確認可能です。

---

## 6. プラグイン連携

Inspector と Player の**両方をインストールしている場合**、以下の連携が使えます。

### Inspector → Player

- **タイルをダブルクリック**: Player が起動（または前面に移動）し、その時点から再生を開始
- **タイルを右クリック → 「Player で再生」**: 同上
- **同じタイルを再度ダブルクリック**: 再生/一時停止を切り替え
- **タイルをシングルクリック**: Player の再生位置をその時点に移動（再生状態は変更しない）

Player が起動していない場合は、プレーヤーを開くよう通知が表示されます。一度開いた Player はウィンドウを閉じても即座に復帰できます。

### Player → Inspector

- Player でタイルを生成/削除すると、Inspector の表示が自動的に更新されます

### Service → Inspector

- Service がタイルを生成すると、Inspector を次に開いた際に自動的に表示されます

### 連携のまとめ

1. **Service**: 動画を追加すると自動でタイルを生成
2. **Inspector**: 選択した動画のタイルを表示・編集したり、手動でタイルを生成
3. **Player**: 動画を再生しつつ、タイムライン・マーカー・タイルビューで細かく操作

必要な組み合わせだけ有効にして使っても問題ありません。

---

## 7. よくある質問

### Q: FFmpeg がインストールされていないと言われます

Eagle の設定画面から FFmpeg をインストールしてください。Eagle メニュー → プラグイン → 設定 → FFmpeg。

### Q: タイル生成に時間がかかります

タイル生成は動画の長さとグリッドサイズに依存します。設定でグリッドサイズを小さくするか、Interval を大きくすると枚数が減り高速になります。Size（px）は画質に影響しますが、生成速度にはあまり影響しません。

### Q: ホバープレビューが動かない

ヘッダーの再生ボタンがオン（ハイライト状態）になっているか確認してください。また、動画形式によってはブラウザでの再生に対応していない場合があります。

### Q: 3 つ全部インストールする必要がありますか？

いいえ。Inspector だけでもタイル表示・ホバープレビューが使え、Player だけでもタイムライン付き再生が使えます。両方入れるとタイルから Player を起動する連携が便利です。Service は、起動中に追加した動画のサムネイルを自動取得したい場合のオプションです。

---

## 8. サポート

不具合・質問はリポジトリ共通の [SUPPORT](../../SUPPORT.md) をご利用ください。対象プラグイン名（VideoTileKunInspector / VideoTileKunPlayer / VideoTileKunService）を明記していただけると助かります。
